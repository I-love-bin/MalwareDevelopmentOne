#include <windows.h>
#include "def.h"

// Conferm either process is elevated or not
bool IsElevatedProcess(HANDLE pHandle) {
	HANDLE hToken;
	TOKEN_ELEVATION tElevation;
	DWORD rLength;
	OpenProcessToken(pHandle, GENERIC_READ, &hToken);
	GetTokenInformation(hToken, TokenElevation, &tElevation, sizeof(tElevation), &rLength);
	if (tElevation.TokenIsElevated != 0) {
		return TRUE;
	}
	return FALSE;
}